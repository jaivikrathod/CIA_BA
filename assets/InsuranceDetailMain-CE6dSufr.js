import{s as F,r as t,u as M,d as N,e as k,j as e}from"./index-CRICFKxU.js";import{y as o,L as T,m as E,n as f,l as A,o as $,M as B}from"./DefaultLayout-C5VH_Vit.js";import"./iconBase-K3-QF6rt.js";const U="/CIA_BA/assets/pdf2-BtyarKZu.png",R=()=>{const{id:y}=F(),[i,v]=t.useState(0),[s,r]=t.useState(!1),[c,g]=t.useState([]),_=M(),d=N(a=>a.apiUrl),[w,b]=t.useState(),D=N(a=>a.id),[x,h]=t.useState({show:!1,id:null}),{register:l,handleSubmit:j,reset:p,formState:{errors:L}}=k();t.useEffect(()=>{n()},[]),t.useEffect(()=>{c.length>0&&p(c[i])},[c,i,p]);const n=async()=>{var a;try{const m=await _.get("/particular-insurance",{params:{common_id:y}});g(m.data.data),((a=m.data)==null?void 0:a.data[0].insurance_type)=="Motor"?b(!0):b(!1)}catch{o.error("Failed to fetch insurance details")}},u=async a=>{try{console.log(a),o.success("Insurance details updated successfully"),r(!1),n()}catch{o.error("Failed to update insurance details")}},C=()=>{r(!1),n()},P=a=>{a.name.toLowerCase().endsWith(".pdf")?window.open(`${d}/get-insurance-docs/${a.name}`,"_blank"):window.open(`${d}/get-insurance-docs/${a.name}`,"_blank")},S=a=>{h({show:!0,id:a})},I=()=>{h({show:!1,id:null}),n()};return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"container mt-4",children:[e.jsx(T,{position:"top-right",autoClose:3e3,hideProgressBar:!0}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-4 insurance-detail-main",children:[e.jsx("h2",{children:"Insurance Details"}),e.jsx("div",{children:s?e.jsxs(e.Fragment,{children:[e.jsxs("button",{className:"btn btn-success me-2",onClick:j(u),children:[e.jsx(E,{className:"me-2"})," Save"]}),e.jsxs("button",{className:"btn btn-common btn-danger",onClick:()=>C(),children:[e.jsx(f,{className:"me-2"})," Cancel"]})]}):e.jsxs("button",{className:"btn btn-primary",onClick:()=>r(!0),children:[e.jsx(A,{className:"me-2"})," Edit"]})})]}),e.jsx("ul",{className:"nav nav-tabs mb-4",children:c.map((a,m)=>e.jsx("li",{className:"nav-item",children:e.jsxs("button",{className:`nav-link ${i===m?"active":""}`,onClick:()=>v(m),children:["Insurance ",m+1]})},a.id))}),e.jsx("div",{className:"tab-content",children:c.length>0&&e.jsx("form",{onSubmit:j(u),children:e.jsx("div",{className:"tab-pane active",children:e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-12 mb-4",children:[e.jsx("h4",{className:"border-bottom pb-2",children:"Basic Information"}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-4 mb-3",children:[e.jsx("label",{className:"form-label",children:"Insurance Type"}),e.jsx("input",{type:"text",className:"form-control",disabled:!s,...l("insurance_type")})]}),e.jsxs("div",{className:"col-md-4 mb-3",children:[e.jsx("label",{className:"form-label",children:"Business Type"}),e.jsx("input",{type:"text",className:"form-control",disabled:!s,...l("business_type")})]}),e.jsxs("div",{className:"col-md-4 mb-3",children:[e.jsx("label",{className:"form-label",children:"Segment"}),e.jsx("input",{type:"text",className:"form-control",disabled:!s,...l("segment")})]})]})]}),w&&e.jsxs("div",{className:"col-12 mb-4",children:[e.jsx("h4",{className:"border-bottom pb-2",children:"Vehicle Information"}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Vehicle Number"}),e.jsx("input",{type:"text",className:"form-control",disabled:!s,...l("vehicle_number")})]}),e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Manufacturer"}),e.jsx("input",{type:"text",className:"form-control",disabled:!s,...l("manufacturer")})]}),e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Model"}),e.jsx("input",{type:"text",className:"form-control",disabled:!s,...l("model")})]}),e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Fuel Type"}),e.jsx("input",{type:"text",className:"form-control",disabled:!s,...l("fuel_type")})]}),e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Year of Manufacture"}),e.jsx("input",{type:"number",className:"form-control",disabled:!s,...l("yom")})]})]})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsx("h4",{className:"border-bottom pb-2",children:"Policy Details"}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Policy Number"}),e.jsx("input",{type:"text",className:"form-control",disabled:!s,...l("policy_no")})]}),e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Insurance Company"}),e.jsx("input",{type:"text",className:"form-control",disabled:!s,...l("insurance_company")})]}),e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"IDV"}),e.jsx("input",{type:"text",className:"form-control",disabled:!s,...l("idv")})]}),e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Current NCB"}),e.jsx("input",{type:"text",className:"form-control",disabled:!s,...l("currentncb")})]})]})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsx("h4",{className:"border-bottom pb-2",children:"Premium Details"}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"OD Premium"}),e.jsx("input",{type:"number",className:"form-control",disabled:!s,...l("od_premium")})]}),e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"TP Premium"}),e.jsx("input",{type:"number",className:"form-control",disabled:!s,...l("tp_premium")})]}),e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Package Premium"}),e.jsx("input",{type:"number",className:"form-control",disabled:!s,...l("package_premium")})]}),e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"GST"}),e.jsx("input",{type:"number",className:"form-control",disabled:!s,...l("gst")})]}),e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Total Premium"}),e.jsx("input",{type:"number",className:"form-control",disabled:!s,...l("premium")})]})]})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsx("h4",{className:"border-bottom pb-2",children:"Important Dates"}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Policy Start Date"}),e.jsx("input",{type:"date",className:"form-control",disabled:!s,...l("policy_start_date")})]}),e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Policy Expiry Date"}),e.jsx("input",{type:"date",className:"form-control",disabled:!s,...l("policy_expiry_date")})]}),e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Collection Date"}),e.jsx("input",{type:"date",className:"form-control",disabled:!s,...l("collection_date")})]}),e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Insurance Date"}),e.jsx("input",{type:"date",className:"form-control",disabled:!s,...l("insurance_date")})]})]})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsx("h4",{className:"border-bottom pb-2",children:"Payment Details"}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Payment Mode"}),e.jsx("input",{type:"text",className:"form-control",disabled:!s,...l("payment_mode")})]}),e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Case Type"}),e.jsx("input",{type:"text",className:"form-control",disabled:!s,...l("case_type")})]}),c[i].case_type=="agent"&&e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Agent Code"}),e.jsx("input",{type:"text",className:"form-control",disabled:!s,...l("agent_id")})]}),c[i].case_type=="office"&&e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Employee"}),e.jsx("input",{type:"text",className:"form-control",disabled:!0,value:c[i].user_id==D?"Self":c[i].full_name})]})]})]}),e.jsxs("div",{className:"col-12 mb-4",children:[e.jsx("h4",{className:"border-bottom pb-2",children:"Financial Details"}),e.jsxs("div",{className:"row",children:[e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Payout Percent"}),e.jsx("input",{type:"number",className:"form-control",disabled:!s,...l("payout_percent")})]}),e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Amount"}),e.jsx("input",{type:"number",className:"form-control",disabled:!s,...l("amount")})]}),e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"TDS"}),e.jsx("input",{type:"number",className:"form-control",disabled:!s,...l("tds")})]}),e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"TDS Amount"}),e.jsx("input",{type:"number",className:"form-control",disabled:!s,...l("tds_amount")})]}),e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Payment Amount"}),e.jsx("input",{type:"number",className:"form-control",disabled:!s,...l("payment_amount")})]}),e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Difference"}),e.jsx("input",{type:"number",className:"form-control",disabled:!s,...l("difference")})]}),e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Net Income"}),e.jsx("input",{type:"number",className:"form-control",disabled:!s,...l("net_income")})]}),e.jsxs("div",{className:"col-md-3 mb-3",children:[e.jsx("label",{className:"form-label",children:"Payment Received"}),e.jsx("input",{type:"number",className:"form-control",disabled:!s,...l("payment_received")})]})]})]}),e.jsxs("div",{className:"col-12 mb-3",children:[e.jsxs("div",{className:"border-bottom pb-3 mb-4 d-flex align-items-center",children:[e.jsx("h4",{className:"mb-0",children:"Documents"}),e.jsx("div",{className:"ms-3",children:e.jsx("div",{onClick:()=>S(c[i].id),className:"d-flex justify-content-center align-items-center rounded-circle bg-primary",style:{width:"20px",height:"20px",cursor:"pointer"},children:e.jsx($,{color:"white",size:10})})})]}),e.jsx("div",{className:"d-flex gap-5 flex-wrap",children:c[i].documents&&JSON.parse(c[i].documents).map((a,m)=>e.jsx(e.Fragment,{children:e.jsx("div",{className:"col-md-3 mb-3",children:e.jsx("div",{className:"card h-100",children:e.jsxs("div",{className:"card-body",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[a.name.toLowerCase().endsWith(".pdf")?e.jsx("div",{className:"position-relative",children:e.jsx("img",{src:U,alt:a.type,className:"img-thumbnail me-2",style:{width:"40px",height:"40px",objectFit:"cover"}})}):e.jsx(e.Fragment,{children:e.jsx("div",{className:"position-relative",children:e.jsx("img",{src:`${d}/get-insurance-docs/${a.name}`,alt:a.type,className:"img-thumbnail me-2",style:{width:"40px",height:"40px",objectFit:"cover"}})})}),e.jsx("div",{children:e.jsx("h6",{className:"card-title mb-0",children:a.type})})]}),e.jsx("button",{type:"button",className:"btn btn-sm btn-outline-primary mt-2",onClick:()=>P(a),children:"View Document"}),e.jsx("div",{className:"ms-3",children:e.jsx("div",{className:"d-flex justify-content-center align-items-center rounded-circle bg-danger position-absolute",style:{width:"20px",height:"20px",cursor:"pointer",top:"-8px",right:"-10px"},children:e.jsx(f,{color:"white",size:10})})})]})})},m)}))})]})]})})})})]}),e.jsx(B,{customerId:x.id,show:x.show,isCustomerDoc:!1,handleClose:I})]})};export{R as default};
