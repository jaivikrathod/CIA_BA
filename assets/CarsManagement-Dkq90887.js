import{r as i,u as p,j as e,e as y}from"./index-CRICFKxU.js";import{L as g,y as d}from"./DefaultLayout-C5VH_Vit.js";import"./iconBase-K3-QF6rt.js";const E=()=>{const[r,a]=i.useState([]),[n,m]=i.useState(null),[x,t]=i.useState(!1),[u,h]=i.useState({show:!1,id:null}),c=p(),l=async()=>{try{const s=await c.get("/cars");a(s.data.data)}catch(s){d.error("Failed to fetch cars"),console.error("Failed to fetch cars:",s)}},N=async s=>{try{const j=await c.delete("/car",{data:{id:s}});d.success(j.data.message),h({show:!1,id:null}),l()}catch(j){d.error("Error deleting car"),console.error("Error deleting car:",j)}},o=s=>{m(s),t(!0)},b=s=>{h({show:!0,id:s})},f=()=>{m({}),t(!0)};return i.useEffect(()=>{l()},[]),e.jsxs("div",{className:"container mt-4",children:[e.jsx(g,{position:"top-right",a:!0,utoClose:3e3,hideProgressBar:!0}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsx("h2",{children:"Vehicle Management"}),e.jsxs("button",{className:"btn btn-primary",onClick:f,children:[e.jsx("i",{className:"fas fa-plus me-2"}),"New Vehicle"]})]}),r.length===0?e.jsx("div",{className:"alert alert-info text-center",role:"alert",children:"No cars found. Please add a new car."}):e.jsx(e.Fragment,{children:e.jsx("div",{style:{maxHeight:"350px",overflowY:"auto",width:"100%"},children:e.jsxs("table",{className:"table table-striped table-hover",style:{marginBottom:0},children:[e.jsx("thead",{className:"thead-dark",style:{position:"sticky",top:0,zIndex:1,background:"#343a40"},children:e.jsxs("tr",{children:[e.jsx("th",{children:"Sr. No."}),e.jsx("th",{children:"Company Name"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Model Name"}),e.jsx("th",{children:"Model Launch Year"}),e.jsx("th",{children:"Other Detail"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:r.map((s,j)=>e.jsxs("tr",{style:{verticalAlign:"middle"},children:[e.jsx("td",{children:j+1}),e.jsx("td",{children:s.company_name}),e.jsx("td",{children:s.type}),e.jsx("td",{children:s.model_name}),e.jsx("td",{children:s.model_launch_year}),e.jsx("td",{children:s.other_detail||"-"}),e.jsxs("td",{children:[e.jsx("button",{className:"btn btn-link",onClick:()=>o(s),title:"Edit",children:e.jsx("i",{className:"fas fa-edit"})}),e.jsx("button",{className:"btn btn-link text-danger",onClick:()=>b(s.id),title:"Delete",children:e.jsx("i",{className:"fas fa-trash-alt"})})]})]},s.id))})]})})}),x&&e.jsx(w,{show:x,car:n,onClose:()=>{t(!1),m(null)},fetchCars:l}),u.show&&e.jsx(C,{show:u.show,onClose:()=>h({show:!1,id:null}),onConfirm:()=>N(u.id)})]})},w=({show:r,car:a,onClose:n,fetchCars:m})=>{const x=p(),{register:t,handleSubmit:u,setValue:h,reset:c,formState:{errors:l}}=y({defaultValues:a||{}});i.useEffect(()=>{a&&Object.keys(a).forEach(o=>h(o,a[o]))},[a,h]),i.useEffect(()=>{r||c()},[r,c]);const N=async o=>{var b,f;try{if(a&&a.id){const s=await x.put("/car",{...o,id:a.id});s.data.success?(d.success(s.data.message),c(),n(),m()):d.error(s.data.message)}else{const s=await x.post("/car",o);s.data.success?(d.success(s.data.message),c(),n(),m()):d.error(s.data.message)}}catch(s){d.error(((f=(b=s==null?void 0:s.response)==null?void 0:b.data)==null?void 0:f.message)||"Error saving car"),console.error("Error saving car:",s)}};return r?e.jsx("div",{className:"modal fade show d-block",tabIndex:"-1",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered modal-lg",children:e.jsxs("div",{className:"modal-content",style:{maxHeight:"90vh",overflowY:"auto"},children:[e.jsxs("div",{className:"modal-header bg-dark text-white",children:[e.jsx("h5",{className:"modal-title",children:a.id?"Edit Car":"New Car"}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:n})]}),e.jsx("div",{className:"modal-body p-4",children:e.jsxs("form",{onSubmit:u(N),children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label fw-bold",children:"Company Name"}),e.jsx("input",{type:"text",...t("company_name",{required:"Company Name is required"}),className:"form-control"}),l.company_name&&e.jsx("small",{className:"text-danger",children:l.company_name.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label fw-bold",children:"Type"}),e.jsx("input",{type:"text",...t("type",{required:"Type is required"}),className:"form-control"}),l.type&&e.jsx("small",{className:"text-danger",children:l.type.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label fw-bold",children:"Model Name"}),e.jsx("input",{type:"text",...t("model_name",{required:"Model Name is required"}),className:"form-control"}),l.model_name&&e.jsx("small",{className:"text-danger",children:l.model_name.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label fw-bold",children:"Model Launch Year"}),e.jsx("input",{type:"number",...t("model_launch_year",{required:"Model Launch Year is required",min:{value:1900,message:"Year must be >= 1900"},max:{value:new Date().getFullYear(),message:`Year must be <= ${new Date().getFullYear()}`}}),className:"form-control"}),l.model_launch_year&&e.jsx("small",{className:"text-danger",children:l.model_launch_year.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label fw-bold",children:"Other Detail"}),e.jsx("textarea",{...t("other_detail"),className:"form-control",rows:2})]}),e.jsxs("div",{className:"d-flex justify-content-end mt-4",children:[e.jsx("button",{type:"submit",className:"btn btn-success px-4",children:a.id?"Update":"Create"}),e.jsx("button",{type:"button",onClick:n,className:"btn btn-secondary ms-2",children:"Cancel"})]})]})})]})})}):null},C=({show:r,onClose:a,onConfirm:n})=>r?e.jsx("div",{className:"modal fade show d-block",tabIndex:"-1",children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Confirm Deletion"}),e.jsx("button",{type:"button",className:"btn-close",onClick:a})]}),e.jsx("div",{className:"modal-body",children:e.jsx("p",{children:"Are you sure you want to delete this car?"})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-danger",onClick:n,children:"Confirm"}),e.jsx("button",{className:"btn btn-secondary",onClick:a,children:"Cancel"})]})]})})}):null;export{E as default};
