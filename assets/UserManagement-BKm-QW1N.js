import{r as x,j as e}from"./index-CpLtnvQD.js";import{a as b}from"./index-t--hEgTQ.js";import{u}from"./index.esm-BXEEmO5K.js";import{u as j,L as f,y as i}from"./DefaultLayout-C0e-1Rj5.js";const w=()=>{const[l,c]=x.useState([]),[t,d]=x.useState(null),[o,r]=x.useState({show:!1,id:null}),a=j(),m=async()=>{try{const s=await a.post("/user-list");c(s.data.data)}catch(s){i.error("Failed to fetch User"),console.error("Failed to fetch User:",s)}},n=async s=>{try{const h=await a.post("/user-delete",{id:s});i.success(h.data.message),r({show:!1,id:null}),m()}catch(h){i.error("Error deleting User"),console.error("Error deleting User:",h)}};return x.useEffect(()=>{m()},[]),e.jsxs("div",{className:"container mt-4",children:[e.jsx(f,{position:"top-right",autoClose:3e3,hideProgressBar:!0}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsx("h2",{children:"User Management"}),e.jsxs("button",{className:"btn btn-primary",onClick:()=>d({}),children:[e.jsx("i",{className:"fas fa-plus me-2"}),"New User"]})]}),l.length===0?e.jsx("div",{className:"alert alert-info text-center",role:"alert",children:"No customers found. Please add a new customer."}):e.jsx(e.Fragment,{children:e.jsxs("table",{className:"table table-bordered table-striped",children:[e.jsx("thead",{className:"thead-dark",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Sr.No"}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Mobile"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:l.map((s,h)=>e.jsxs("tr",{children:[e.jsx("td",{children:h+1}),e.jsx("td",{children:s.full_name}),e.jsx("td",{children:s.email}),e.jsx("td",{children:s.mobile}),e.jsxs("td",{children:[e.jsx("button",{className:"btn btn-link text-warning p-0 me-2",onClick:()=>d(s),title:"Edit",children:e.jsx("i",{className:"fas fa-edit"})}),e.jsx("button",{className:"btn btn-link text-danger p-0",onClick:()=>r({show:!0,id:s.id}),title:"Delete",children:e.jsx("i",{className:"fas fa-trash-alt"})})]})]},s.id))})]})}),t!==null&&e.jsx(N,{User:t,onClose:()=>{d(null),m()}}),o.show&&e.jsx("div",{className:"modal show d-block",tabIndex:"-1",children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Confirm Deletion"}),e.jsx("button",{type:"button",className:"btn-close",onClick:()=>r({show:!1,id:null})})]}),e.jsx("div",{className:"modal-body",children:e.jsx("p",{children:"Are you sure you want to delete this User?"})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-danger",onClick:()=>n(o.id),children:"Confirm"}),e.jsx("button",{className:"btn btn-secondary",onClick:()=>r({show:!1,id:null}),children:"Cancel"})]})]})})})]})},N=({User:l,onClose:c})=>{const{register:t,handleSubmit:d,setValue:o,reset:r,formState:{errors:a}}=u({defaultValues:l||{}});x.useEffect(()=>{l&&Object.keys(l).forEach(n=>o(n,l[n]))},[l,o]);const m=async n=>{try{const s=await b.post(`${api}/user-create-edit`,n);s.data.success?(i.success(s.data.message),r(),c()):i.error(s.data.message)}catch(s){i.error("Error while saving User, Try again!.."),console.error("Error saving User:",s)}};return e.jsx("div",{className:"modal fade show d-block",tabIndex:"-1",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered modal-lg",children:e.jsxs("div",{className:"modal-content",style:{maxHeight:"90vh",overflowY:"auto"},children:[e.jsxs("div",{className:"modal-header bg-dark text-white",children:[e.jsx("h5",{className:"modal-title",children:l.id?"Edit User":"New User"}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:c})]}),e.jsx("div",{className:"modal-body p-4",children:e.jsxs("form",{onSubmit:d(m),children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label fw-bold",children:"Full Name"}),e.jsx("input",{type:"text",...t("full_name",{required:"Full Name is required"}),className:"form-control"}),a.full_name&&e.jsx("small",{className:"text-danger",children:a.full_name.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label fw-bold",children:"Email"}),e.jsx("input",{type:"email",...t("email",{required:"Email is required"}),className:"form-control"}),a.email&&e.jsx("small",{className:"text-danger",children:a.email.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label fw-bold",children:"Mobile"}),e.jsx("input",{type:"text",...t("mobile",{required:"Mobile Number is required"}),className:"form-control"}),a.mobile&&e.jsx("small",{className:"text-danger",children:a.mobile.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label fw-bold",children:"Type"}),e.jsxs("select",{...t("type"),className:"form-select",children:[e.jsx("option",{value:"Admin",children:"Admin"}),e.jsx("option",{value:"Sub-admin",children:"Sub-admin"})]})]}),e.jsxs("div",{className:"d-flex justify-content-end mt-4",children:[e.jsx("button",{type:"submit",className:"btn btn-success px-4",children:l.id?"Update":"Create"}),e.jsx("button",{type:"button",onClick:c,className:"btn btn-secondary ms-2",children:"Cancel"})]})]})})]})})})};export{w as default};
