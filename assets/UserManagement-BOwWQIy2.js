import{r as c,u as p,j as e,e as g}from"./index-CRICFKxU.js";import{L as y,y as m}from"./DefaultLayout-C5VH_Vit.js";import"./iconBase-K3-QF6rt.js";const E=()=>{const[r,l]=c.useState([]),[i,h]=c.useState(null),[b,n]=c.useState(!1),[x,d]=c.useState({show:!1,id:null}),o=p(),t=async()=>{try{const s=await o.post("/user-list");l(s.data.data)}catch(s){m.error("Failed to fetch User"),console.error("Failed to fetch User:",s)}},N=async s=>{try{const u=await o.post("/user-delete",{id:s});m.success(u.data.message),d({show:!1,id:null}),t()}catch(u){m.error("Error deleting User"),console.error("Error deleting User:",u)}},a=s=>{h(s),n(!0)},j=s=>{d({show:!0,id:s})},f=()=>{h({}),n(!0)};return c.useEffect(()=>{t()},[]),e.jsxs("div",{className:"container mt-4",children:[e.jsx(y,{position:"top-right",autoClose:3e3,hideProgressBar:!0}),e.jsxs("div",{className:"d-flex justify-content-between align-items-center mb-3",children:[e.jsx("h2",{children:"User Management"}),e.jsxs("button",{className:"btn btn-primary",onClick:f,children:[e.jsx("i",{className:"fas fa-plus me-2"}),"New User"]})]}),r.length===0?e.jsx("div",{className:"alert alert-info text-center",role:"alert",children:"No users found. Please add a new user."}):e.jsx(e.Fragment,{children:e.jsx("div",{style:{maxHeight:"350px",overflowY:"auto",width:"100%"},children:e.jsxs("table",{className:"table table-striped table-hover",style:{marginBottom:0},children:[e.jsx("thead",{className:"thead-dark",style:{position:"sticky",top:0,zIndex:1,background:"#343a40"},children:e.jsxs("tr",{children:[e.jsx("th",{children:"Sr. No."}),e.jsx("th",{children:"Name"}),e.jsx("th",{children:"Email"}),e.jsx("th",{children:"Mobile"}),e.jsx("th",{children:"Type"}),e.jsx("th",{children:"Actions"})]})}),e.jsx("tbody",{children:r.map((s,u)=>e.jsxs("tr",{style:{verticalAlign:"middle"},children:[e.jsx("td",{children:u+1}),e.jsx("td",{children:s.full_name}),e.jsx("td",{children:s.email}),e.jsx("td",{children:s.mobile}),e.jsx("td",{children:s.type||"N/A"}),e.jsxs("td",{children:[e.jsx("button",{className:"btn btn-link",onClick:()=>a(s),title:"Edit",children:e.jsx("i",{className:"fas fa-edit"})}),e.jsx("button",{className:"btn btn-link text-danger",onClick:()=>j(s.id),title:"Delete",children:e.jsx("i",{className:"fas fa-trash-alt"})})]})]},s.id))})]})})}),b&&e.jsx(v,{show:b,User:i,onClose:()=>{n(!1),h(null)},fetchUser:t}),x.show&&e.jsx(w,{show:x.show,onClose:()=>d({show:!1,id:null}),onConfirm:()=>N(x.id)})]})},v=({show:r,User:l,onClose:i,fetchUser:h})=>{const b=p(),{register:n,handleSubmit:x,setValue:d,reset:o,formState:{errors:t}}=g({defaultValues:l||{}});c.useEffect(()=>{l&&Object.keys(l).forEach(a=>d(a,l[a]))},[l,d]),c.useEffect(()=>{r||o()},[r,o]);const N=async a=>{var j,f;try{const s=await b.post("/user-create-edit",a);s.data.success?(m.success(s.data.message),o(),i(),h()):m.error(s.data.message)}catch(s){m.error(((f=(j=s==null?void 0:s.response)==null?void 0:j.data)==null?void 0:f.message)||"Error saving User"),console.error("Error saving User:",s)}};return r?e.jsx("div",{className:"modal fade show d-block",tabIndex:"-1",children:e.jsx("div",{className:"modal-dialog modal-dialog-centered modal-lg",children:e.jsxs("div",{className:"modal-content",style:{maxHeight:"90vh",overflowY:"auto"},children:[e.jsxs("div",{className:"modal-header bg-dark text-white",children:[e.jsx("h5",{className:"modal-title",children:l.id?"Edit User":"New User"}),e.jsx("button",{type:"button",className:"btn-close btn-close-white",onClick:i})]}),e.jsx("div",{className:"modal-body p-4",children:e.jsxs("form",{onSubmit:x(N),children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label fw-bold",children:"Full Name"}),e.jsx("input",{type:"text",...n("full_name",{required:"Full Name is required"}),className:"form-control"}),t.full_name&&e.jsx("small",{className:"text-danger",children:t.full_name.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label fw-bold",children:"Email"}),e.jsx("input",{type:"email",...n("email",{required:"Email is required"}),className:"form-control"}),t.email&&e.jsx("small",{className:"text-danger",children:t.email.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label fw-bold",children:"Mobile"}),e.jsx("input",{type:"text",maxLength:10,...n("mobile",{required:"Mobile Number is required",pattern:{value:/^[0-9]{10}$/,message:"Mobile number must be exactly 10 digits"},validate:a=>a&&!/^\d+$/.test(a)?"Only numbers are allowed":!0}),className:"form-control"}),t.mobile&&e.jsx("small",{className:"text-danger",children:t.mobile.message})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"form-label fw-bold",children:"Type"}),e.jsxs("select",{...n("type"),className:"form-select",children:[e.jsx("option",{value:"Admin",children:"Admin"}),e.jsx("option",{value:"Sub-admin",children:"Sub-admin"})]})]}),e.jsxs("div",{className:"d-flex justify-content-end mt-4",children:[e.jsx("button",{type:"submit",className:"btn btn-success px-4",children:l.id?"Update":"Create"}),e.jsx("button",{type:"button",onClick:i,className:"btn btn-secondary ms-2",children:"Cancel"})]})]})})]})})}):null},w=({show:r,onClose:l,onConfirm:i})=>r?e.jsx("div",{className:"modal fade show d-block",tabIndex:"-1",children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h5",{className:"modal-title",children:"Confirm Deletion"}),e.jsx("button",{type:"button",className:"btn-close",onClick:l})]}),e.jsx("div",{className:"modal-body",children:e.jsx("p",{children:"Are you sure you want to delete this User?"})}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{className:"btn btn-danger",onClick:i,children:"Confirm"}),e.jsx("button",{className:"btn btn-secondary",onClick:l,children:"Cancel"})]})]})})}):null;export{E as default};
